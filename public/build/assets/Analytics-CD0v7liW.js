import{C as h,r as N}from"./chart-Co7ClN-s.js";import{_ as P}from"./AuthenticatedLayout-CE5IocYa.js";import{r as C,c as v,o as W,w as T,a as U,b as _,d as F,e as A,u as G,h as J,f as E,g as t,t as i,F as S,i as O,n as Q}from"./app-R1WeOlpQ.js";const Z={class:"py-8"},q={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6"},K={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},X={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-6"},Y={class:"flex items-center"},tt={class:"ml-4"},et={class:"text-2xl font-semibold text-gray-900 dark:text-white"},st={class:"text-xs text-green-600 dark:text-green-400 mt-1"},at={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-6"},rt={class:"flex items-center"},ot={class:"ml-4"},nt={class:"text-2xl font-semibold text-gray-900 dark:text-white"},it={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-6"},lt={class:"flex items-center"},dt={class:"ml-4"},ct={class:"text-2xl font-semibold text-gray-900 dark:text-white"},ut={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-6"},mt={class:"flex items-center"},gt={class:"ml-4"},xt={class:"text-2xl font-semibold text-gray-900 dark:text-white"},ft={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},pt={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},yt={class:"p-6"},ht={class:"h-80"},vt={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},bt={class:"p-6"},kt={class:"flex items-center justify-between mb-4"},wt={class:"text-sm text-gray-500 dark:text-gray-400"},Ct={class:"h-80"},_t={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},Ft={class:"p-6"},Bt={class:"h-80"},Mt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Rt={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},At={class:"p-6"},Et={class:"space-y-4"},St={class:"flex items-center"},zt={class:"flex-shrink-0"},Dt={class:"w-8 h-8 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full flex items-center justify-center"},jt={class:"text-white text-sm font-medium"},It={class:"ml-3"},Lt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},$t={class:"text-xs text-gray-600 dark:text-gray-400"},Ht={class:"text-right"},Vt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Tt={__name:"Analytics",props:{analytics:{type:Object,default:()=>({monthly_revenue:0,renewal_rate:0,new_clients_month:0,lifetime_licenses:0,total_licenses:0,plan_distribution:{basic:0,professional:0,enterprise:0}})},topClients:{type:Array,default:()=>[]},usageData:{type:Array,default:()=>[]}},setup(u){h.register(...N);const m=u,b=C(null),g=C(null),k=C(null);let l=null,d=null,c=null;const z=v(()=>{if(m.usageData&&m.usageData.length>0)return m.usageData.map(a=>({date:a.label,count:a.value}));const s=[],e=new Date,o=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"];for(let a=6;a>=0;a--){const r=new Date(e);r.setDate(r.getDate()-a),s.push({date:o[r.getDay()],count:0})}return s}),B=v(()=>{const s=m.analytics?.plan_distribution||{};return{basic:s.basic||0,professional:s.professional||0,enterprise:s.enterprise||0}}),D=v(()=>{const s=B.value;return s.basic+s.professional+s.enterprise}),j=v(()=>{const s=m.analytics?.monthly_revenue||0,e=m.analytics?.total_revenue||0,o=m.analytics?.plan_revenue||{};o.basic,o.professional,o.enterprise;const a=[],r=new Date,p=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],x=e>0?e/6:s;for(let n=5;n>=0;n--){const y=new Date(r);y.setMonth(y.getMonth()-n);let f;if(n===0)f=s;else if(n===1)f=Math.round(s*(.85+Math.random()*.1));else{const w=.7+Math.random()*.6;f=Math.round(x*w)}a.push({month:p[y.getMonth()],revenue:Math.max(f,0)})}return a}),I=()=>{if(!b.value)return;l&&(l.destroy(),l=null);const s=z.value,e=b.value.getContext("2d"),o=e.createLinearGradient(0,0,0,400);o.addColorStop(0,"rgba(99, 102, 241, 0.4)"),o.addColorStop(1,"rgba(99, 102, 241, 0.05)"),l=new h(e,{type:"line",data:{labels:s.map(a=>a.date),datasets:[{label:"Verificações de Licença",data:s.map(a=>a.count),borderColor:"#6366F1",backgroundColor:o,borderWidth:3,fill:!0,tension:.4,pointBackgroundColor:"#6366F1",pointBorderColor:"#ffffff",pointBorderWidth:3,pointRadius:6,pointHoverRadius:8,pointHoverBackgroundColor:"#4F46E5",pointHoverBorderColor:"#ffffff",pointHoverBorderWidth:3}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},layout:{padding:{top:20,bottom:20,left:20,right:20}},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.95)",titleColor:"#F9FAFB",bodyColor:"#F9FAFB",titleFont:{size:12,family:"Inter, system-ui, sans-serif",weight:"600"},bodyFont:{size:11,family:"Inter, system-ui, sans-serif"},cornerRadius:8,displayColors:!1,padding:12}},scales:{y:{beginAtZero:!0,ticks:{stepSize:Math.max(1,Math.ceil(Math.max(...s.map(a=>a.count))/5)),font:{size:11,family:"Inter, system-ui, sans-serif"},color:"#E5E7EB"},grid:{color:"rgba(229, 231, 235, 0.2)",drawBorder:!1}},x:{ticks:{font:{size:11,family:"Inter, system-ui, sans-serif"},color:"#E5E7EB"},grid:{display:!1}}}}})},L=()=>{if(!g.value)return;d&&(d.destroy(),d=null);const s=B.value,e=s.basic+s.professional+s.enterprise;if(e===0){const a=g.value.getContext("2d");a.clearRect(0,0,g.value.width,g.value.height),a.fillStyle="#9CA3AF",a.font="14px Inter, system-ui, sans-serif",a.textAlign="center",a.fillText("Nenhum dado disponível",g.value.width/2,g.value.height/2);return}const o=g.value.getContext("2d");d=new h(o,{type:"doughnut",data:{labels:["Básico","Profissional","Empresarial"],datasets:[{data:[s.basic,s.professional,s.enterprise],backgroundColor:["#F59E0B","#3B82F6","#EF4444"],borderColor:["#F59E0B","#3B82F6","#EF4444"],borderWidth:3,cutout:"60%",hoverBackgroundColor:["#F97316","#2563EB","#DC2626"],hoverBorderWidth:4}]},options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:15},plugins:{legend:{position:"bottom",labels:{padding:25,usePointStyle:!0,pointStyle:"circle",font:{size:14,family:"Inter, system-ui, sans-serif",weight:"600"},boxWidth:16,boxHeight:16,color:"#F9FAFB",generateLabels:function(a){const r=a.data;return r.labels.length&&r.datasets.length?r.labels.map((p,x)=>{const n=r.datasets[0],y=n.data[x],f=n.data.reduce((H,V)=>H+V,0),w=f>0?Math.round(y/f*100):0;return{text:`${p} (${y} - ${w}%)`,fillStyle:n.backgroundColor[x],strokeStyle:n.backgroundColor[x],lineWidth:0,pointStyle:"circle",hidden:!1,index:x,fontColor:"#F9FAFB"}}):[]}}},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.95)",titleColor:"#F9FAFB",bodyColor:"#F9FAFB",titleFont:{size:12,family:"Inter, system-ui, sans-serif",weight:"600"},bodyFont:{size:11,family:"Inter, system-ui, sans-serif"},cornerRadius:8,displayColors:!0,padding:12,callbacks:{label:function(a){const r=a.label,p=a.parsed,x=Math.round(p/e*100);return`${r}: ${p} licenças (${x}%)`}}}}}})},$=()=>{if(!k.value)return;c&&(c.destroy(),c=null);const s=j.value,e=k.value.getContext("2d"),o=e.createLinearGradient(0,0,0,400);o.addColorStop(0,"rgba(34, 197, 94, 0.9)"),o.addColorStop(.5,"rgba(34, 197, 94, 0.7)"),o.addColorStop(1,"rgba(34, 197, 94, 0.4)");const a=e.createLinearGradient(0,0,0,400);a.addColorStop(0,"rgba(21, 128, 61, 0.9)"),a.addColorStop(1,"rgba(21, 128, 61, 0.5)"),c=new h(e,{type:"bar",data:{labels:s.map(r=>r.month),datasets:[{label:"Receita (R$)",data:s.map(r=>r.revenue),backgroundColor:o,hoverBackgroundColor:a,borderColor:"#22C55E",borderWidth:2,borderRadius:{topLeft:8,topRight:8},maxBarThickness:60}]},options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{top:20,bottom:20,left:20,right:20}},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.95)",titleColor:"#F9FAFB",bodyColor:"#F9FAFB",titleFont:{size:12,family:"Inter, system-ui, sans-serif",weight:"600"},bodyFont:{size:11,family:"Inter, system-ui, sans-serif"},cornerRadius:8,displayColors:!1,padding:12,callbacks:{label:function(r){return`Receita: R$ ${R(r.parsed.y)}`}}}},scales:{y:{beginAtZero:!0,ticks:{font:{size:11,family:"Inter, system-ui, sans-serif"},color:"#E5E7EB",callback:function(r){return r>=1e6?"R$ "+(r/1e6).toFixed(1)+"M":r>=1e3?"R$ "+(r/1e3).toFixed(0)+"k":"R$ "+new Intl.NumberFormat("pt-BR").format(r)}},grid:{color:"rgba(229, 231, 235, 0.2)",drawBorder:!1}},x:{ticks:{font:{size:11,family:"Inter, system-ui, sans-serif"},color:"#E5E7EB"},grid:{display:!1}}},elements:{bar:{borderSkipped:!1}}}})},M=async()=>{await Q(),l&&(l.destroy(),l=null),d&&(d.destroy(),d=null),c&&(c.destroy(),c=null),setTimeout(()=>{I(),L(),$()},100)},R=s=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s);return W(()=>{M()}),T(()=>m.analytics,()=>{M()},{deep:!0}),U(()=>{l&&l.destroy(),d&&d.destroy(),c&&c.destroy()}),(s,e)=>(F(),_(S,null,[A(G(J),{title:"Analytics"}),A(P,null,{header:E(()=>e[0]||(e[0]=[t("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," Analytics e Relatórios ",-1)])),default:E(()=>[t("div",Z,[t("div",q,[t("div",K,[t("div",X,[t("div",Y,[e[2]||(e[2]=t("div",{class:"p-3 rounded-full bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900 dark:to-emerald-900"},[t("svg",{class:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})])],-1)),t("div",tt,[e[1]||(e[1]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Receita Mensal",-1)),t("p",et,"R$ "+i(R(u.analytics?.monthly_revenue||0)),1),t("p",st," +"+i(Math.round((u.analytics?.monthly_revenue||0)/Math.max(u.analytics?.total_revenue||1,1)*100))+"% do total ",1)])])]),t("div",at,[t("div",rt,[e[5]||(e[5]=t("div",{class:"p-3 rounded-full bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-indigo-900 dark:to-purple-900"},[t("svg",{class:"w-6 h-6 text-indigo-600 dark:text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})])],-1)),t("div",ot,[e[3]||(e[3]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Taxa de Renovação",-1)),t("p",nt,i(u.analytics?.renewal_rate||0)+"%",1),e[4]||(e[4]=t("p",{class:"text-xs text-indigo-600 dark:text-indigo-400 mt-1"}," Últimos 30 dias ",-1))])])]),t("div",it,[t("div",lt,[e[8]||(e[8]=t("div",{class:"p-3 rounded-full bg-gradient-to-br from-amber-100 to-orange-100 dark:from-amber-900 dark:to-orange-900"},[t("svg",{class:"w-6 h-6 text-amber-600 dark:text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),t("div",dt,[e[6]||(e[6]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Novos Clientes",-1)),t("p",ct,i(u.analytics?.new_clients_month||0),1),e[7]||(e[7]=t("p",{class:"text-xs text-amber-600 dark:text-amber-400 mt-1"}," Este mês ",-1))])])]),t("div",ut,[t("div",mt,[e[11]||(e[11]=t("div",{class:"p-3 rounded-full bg-gradient-to-br from-pink-100 to-rose-100 dark:from-pink-900 dark:to-rose-900"},[t("svg",{class:"w-6 h-6 text-pink-600 dark:text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})])],-1)),t("div",gt,[e[9]||(e[9]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Licenças Lifetime",-1)),t("p",xt,i(u.analytics?.lifetime_licenses||0),1),e[10]||(e[10]=t("p",{class:"text-xs text-pink-600 dark:text-pink-400 mt-1"}," Sem expiração ",-1))])])])]),t("div",ft,[t("div",pt,[t("div",yt,[e[12]||(e[12]=t("div",{class:"flex items-center justify-between mb-4"},[t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Uso de Licenças "),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Últimos 7 dias")],-1)),t("div",ht,[t("canvas",{ref_key:"usageChart",ref:b,class:"max-w-full max-h-full"},null,512)])])]),t("div",vt,[t("div",bt,[t("div",kt,[e[13]||(e[13]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Distribuição por Plano ",-1)),t("span",wt,"Total: "+i(D.value),1)]),t("div",Ct,[t("canvas",{ref_key:"planChart",ref:g,class:"max-w-full max-h-full"},null,512)])])])]),t("div",_t,[t("div",Ft,[e[14]||(e[14]=t("div",{class:"flex items-center justify-between mb-4"},[t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Receita Mensal "),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Últimos 6 meses")],-1)),t("div",Bt,[t("canvas",{ref_key:"revenueChart",ref:k,class:"max-w-full max-h-full"},null,512)])])]),t("div",Mt,[t("div",Rt,[t("div",At,[e[16]||(e[16]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4"}," Clientes Mais Ativos ",-1)),t("div",Et,[(F(!0),_(S,null,O(u.topClients,o=>(F(),_("div",{key:o.id,class:"flex items-center justify-between"},[t("div",St,[t("div",zt,[t("div",Dt,[t("span",jt,i(o.client_name.charAt(0).toUpperCase()),1)])]),t("div",It,[t("p",Lt,i(o.client_name),1),t("p",$t,i(o.plan_type),1)])]),t("div",Ht,[t("p",Vt,i(o.usage_count)+" verificações ",1),e[15]||(e[15]=t("p",{class:"text-xs text-gray-600 dark:text-gray-400"}," Últimos 30 dias ",-1))])]))),128))])])]),e[17]||(e[17]=t("div",{class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},[t("div",{class:"p-6"},[t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4"}," Status do Sistema "),t("div",{class:"space-y-4"},[t("div",{class:"flex items-center justify-between"},[t("div",{class:"flex items-center"},[t("div",{class:"w-3 h-3 bg-green-400 rounded-full mr-3"}),t("span",{class:"text-sm text-gray-900 dark:text-gray-100"},"API Status")]),t("span",{class:"text-sm font-medium text-green-600 dark:text-green-400"},"Online")]),t("div",{class:"flex items-center justify-between"},[t("div",{class:"flex items-center"},[t("div",{class:"w-3 h-3 bg-green-400 rounded-full mr-3"}),t("span",{class:"text-sm text-gray-900 dark:text-gray-100"},"Banco de Dados")]),t("span",{class:"text-sm font-medium text-green-600 dark:text-green-400"},"Conectado")]),t("div",{class:"flex items-center justify-between"},[t("div",{class:"flex items-center"},[t("div",{class:"w-3 h-3 bg-yellow-400 rounded-full mr-3"}),t("span",{class:"text-sm text-gray-900 dark:text-gray-100"},"Cache")]),t("span",{class:"text-sm font-medium text-yellow-600 dark:text-yellow-400"},"Parcial")]),t("div",{class:"flex items-center justify-between"},[t("div",{class:"flex items-center"},[t("div",{class:"w-3 h-3 bg-green-400 rounded-full mr-3"}),t("span",{class:"text-sm text-gray-900 dark:text-gray-100"},"Uptime")]),t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"99.8%")])])])],-1))]),e[18]||(e[18]=t("div",{class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},[t("div",{class:"p-6"},[t("div",{class:"flex items-center justify-between mb-4"},[t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Exportar Relatórios ")]),t("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-4"},[t("button",{class:"flex items-center p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg hover:border-primary-500 dark:hover:border-primary-400 transition-colors duration-200"},[t("svg",{class:"w-8 h-8 text-green-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})]),t("div",null,[t("p",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"}," Exportar Excel "),t("p",{class:"text-xs text-gray-600 dark:text-gray-400"}," Relatório completo de licenças ")])]),t("button",{class:"flex items-center p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg hover:border-primary-500 dark:hover:border-primary-400 transition-colors duration-200"},[t("svg",{class:"w-8 h-8 text-red-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})]),t("div",null,[t("p",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"}," Exportar PDF "),t("p",{class:"text-xs text-gray-600 dark:text-gray-400"}," Relatório visual e gráficos ")])]),t("button",{class:"flex items-center p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg hover:border-primary-500 dark:hover:border-primary-400 transition-colors duration-200"},[t("svg",{class:"w-8 h-8 text-blue-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2v0a2 2 0 01-2-2v-2a2 2 0 00-2-2H8z"})]),t("div",null,[t("p",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"}," Exportar CSV "),t("p",{class:"text-xs text-gray-600 dark:text-gray-400"}," Dados brutos para análise ")])])])])],-1))])])]),_:1})],64))}};export{Tt as default};
